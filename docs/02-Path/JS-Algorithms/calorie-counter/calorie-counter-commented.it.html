<!DOCTYPE html>
<!-- ğŸ¯ DICHIARAZIONE HTML5: "Benvenuti nel ristorante digitale delle calorie!" -->
<!-- Ãˆ come aprire un diario alimentare interattivo! ğŸ“” -->

<html lang="en">
<!-- ğŸŒ CONTENITORE PRINCIPALE: La nostra app per il fitness -->
<!-- lang="en" = inglese, la lingua universale della nutrizione! ğŸ¥— -->

  <head>
    <!-- ğŸ§  IL NUTRIZIONISTA DIGITALE: Dove pianifichiamo il tracking -->
    <!-- Ãˆ come avere un dietologo nel browser! -->
    
    <meta charset="utf-8" />
    <!-- ğŸ“ CARATTERI UNIVERSALI: UTF-8 per emoji del cibo! ğŸ•ğŸ¥¦ğŸ° -->
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- ğŸ“± RESPONSIVE: "Conta calorie su ogni dispositivo!" -->
    
    <title>Calorie Counter</title>
    <!-- ğŸ“‘ TITOLO: Semplice e diretto come una bilancia -->
    
    <style>
      /* ğŸ¨ ===== PALETTE COLORI: I Sapori del Design ===== */
      
      :root {
        /* ğŸ¨ VARIABILI CSS: La tavolozza del nutrizionista */
        --light-grey: #f5f6f7;
        /* ğŸŒ«ï¸ GRIGIO CHIARO: Come il vapore di una tisana */
        
        --dark-blue: #0a0a23;
        /* ğŸŒ‘ BLU SCURO: Professionale come un camice */
        
        --fcc-blue: #1b1b32;
        /* ğŸ’™ BLU FREECODECAMP: Il brand! */
        
        --light-yellow: #fecc4c;
        /* ğŸŒŸ GIALLO CHIARO: Come il sole vitamina D */
        
        --dark-yellow: #feac32;
        /* ğŸŒ GIALLO SCURO: Per i bordi dei bottoni */
        
        --light-pink: #ffadad;
        /* ğŸŒ¸ ROSA CHIARO: Per il surplus (troppo cibo!) */
        
        --dark-red: #850000;
        /* ğŸ”´ ROSSO SCURO: Allerta! (non usato qui) */
        
        --light-green: #acd157;
        /* ğŸŒ¿ VERDE CHIARO: Per il deficit (obiettivo raggiunto!) */
      }
      
      body {
        font-family: "Lato", Helvetica, Arial, sans-serif;
        /* ğŸ”¤ FONT LATO: Pulito e leggibile come un'etichetta nutrizionale */
        
        font-size: 18px;
        /* ğŸ“ DIMENSIONE BASE: Grande abbastanza per non affaticare */
        
        background-color: var(--fcc-blue);
        /* ğŸ¨ SFONDO: Blu scuro professionale */
        
        color: var(--light-grey);
        /* ğŸ”¤ TESTO: Grigio chiaro per contrasto morbido */
      }
      
      h1 {
        text-align: center;
        /* âš–ï¸ CENTRATO: Il titolo domina la scena */
      }
      
      .container {
        width: 90%;
        /* ğŸ“ LARGHEZZA: 90% dello schermo */
        
        max-width: 680px;
        /* ğŸš« LIMITE: Non piÃ¹ largo di 680px */
        /* Ãˆ come un piatto che non puÃ² essere troppo grande */
      }
      
      h1,
      .container,
      .output {
        margin: 20px auto;
        /* âš–ï¸ CENTRATURA + SPAZIO: 20px sopra/sotto, auto ai lati */
        /* Il trucco universale per centrare! */
      }
      
      label,
      legend {
        font-weight: bold;
        /* ğŸ’ª GRASSETTO: Le etichette devono risaltare */
        /* Come i titoli sul menu di un ristorante */
      }
      
      .input-container {
        display: flex;
        flex-direction: column;
        /* ğŸ“¦ FLEX VERTICALE: Input uno sotto l'altro */
        /* Ãˆ come impilare i piatti */
      }
      
      button {
        cursor: pointer;
        /* ğŸ‘† MANINA: "Sono cliccabile!" */
        
        text-decoration: none;
        /* ğŸš« NO SOTTOLINEATURA: Pulito */
        
        background-color: var(--light-yellow);
        /* ğŸŒŸ SFONDO GIALLO: Attira l'attenzione */
        
        border: 2px solid var(--dark-yellow);
        /* ğŸ–¼ï¸ BORDO: Giallo scuro per definizione */
      }
      
      button,
      input,
      select {
        min-height: 24px;
        /* ğŸ“ ALTEZZA MINIMA: Per essere touch-friendly */
        
        color: var(--dark-blue);
        /* ğŸ”¤ TESTO SCURO: Per leggibilitÃ  */
      }
      
      fieldset,
      label,
      button,
      input,
      select {
        margin-bottom: 10px;
        /* â¬‡ï¸ SPAZIO SOTTO: Respiro tra elementi */
      }
      
      .output {
        border: 2px solid var(--light-grey);
        /* ğŸ–¼ï¸ BORDO OUTPUT: Definisce l'area risultati */
        
        padding: 10px;
        /* ğŸ  PADDING: Spazio interno confortevole */
        
        text-align: center;
        /* âš–ï¸ CENTRATO: I risultati al centro dell'attenzione */
      }
      
      .hide {
        display: none;
        /* ğŸ‘» NASCOSTO: Classe utility per nascondere elementi */
      }
      
      .output span {
        font-weight: bold;
        font-size: 1.2em;
        /* ğŸ“ RISULTATO PRINCIPALE: 120% piÃ¹ grande e grassetto */
      }
      
      .surplus {
        color: var(--light-pink);
        /* ğŸŒ¸ SURPLUS: Rosa = hai mangiato troppo! */
      }
      
      .deficit {
        color: var(--light-green);
        /* ğŸŒ¿ DEFICIT: Verde = sei in linea con gli obiettivi! */
      }
    </style>
  </head>
  <body>
    <!-- ğŸ½ï¸ ===== L'APP PRENDE VITA ===== -->
    
    <main>
      <h1>Calorie Counter</h1>
      <!-- ğŸ† TITOLO: Il nostro contatore personale -->
      
      <div class="container">
        <!-- ğŸ“¦ CONTENITORE: Limita la larghezza per leggibilitÃ  -->
        
        <form id="calorie-counter">
          <!-- ğŸ“ FORM PRINCIPALE: Il cuore dell'applicazione -->
          
          <label for="budget">Budget</label>
          <input
            type="number"
            min="0"
            id="budget"
            placeholder="Daily calorie budget"
            required
          />
          <!-- ğŸ’° BUDGET CALORICO: Il tuo obiettivo giornaliero -->
          <!-- type="number" = solo numeri -->
          <!-- min="0" = no numeri negativi -->
          <!-- required = campo obbligatorio -->
          
          <!-- ğŸ½ï¸ ===== I 5 PASTI/CATEGORIE ===== -->
          
          <fieldset id="breakfast">
            <!-- ğŸŒ… COLAZIONE: Il pasto piÃ¹ importante! -->
            <legend>Breakfast</legend>
            <!-- ğŸ·ï¸ LEGEND: Il titolo del fieldset -->
            
            <div class="input-container"></div>
            <!-- ğŸ“¦ CONTENITORE VUOTO: Qui JS aggiungerÃ  gli input -->
          </fieldset>
          
          <fieldset id="lunch">
            <!-- ğŸŒ PRANZO: Energia a metÃ  giornata -->
            <legend>Lunch</legend>
            <div class="input-container"></div>
          </fieldset>
          
          <fieldset id="dinner">
            <!-- ğŸŒ™ CENA: Il pasto serale -->
            <legend>Dinner</legend>
            <div class="input-container"></div>
          </fieldset>
          
          <fieldset id="snacks">
            <!-- ğŸ¿ SNACK: Gli spuntini tra i pasti -->
            <legend>Snacks</legend>
            <div class="input-container"></div>
          </fieldset>
          
          <fieldset id="exercise">
            <!-- ğŸƒ ESERCIZIO: Calorie bruciate! -->
            <legend>Exercise</legend>
            <div class="input-container"></div>
          </fieldset>
          
          <div class="controls">
            <!-- ğŸ® CONTROLLI: Per aggiungere nuove voci -->
            <span>
              <label for="entry-dropdown">Add food or exercise:</label>
              <select id="entry-dropdown" name="options">
                <!-- ğŸ“‹ DROPDOWN: Scegli dove aggiungere -->
                <option value="breakfast" selected>Breakfast</option>
                <option value="lunch">Lunch</option>
                <option value="dinner">Dinner</option>
                <option value="snacks">Snacks</option>
                <option value="exercise">Exercise</option>
              </select>
              <button type="button" id="add-entry">Add Entry</button>
              <!-- ğŸ”˜ AGGIUNGI: Crea nuovi campi dinamicamente -->
              <!-- type="button" = non invia il form -->
            </span>
          </div>
          <div>
            <button type="submit">
              Calculate Remaining Calories
            </button>
            <!-- ğŸ§® CALCOLA: Il bottone principale -->
            <!-- type="submit" = invia il form -->
            
            <button type="button" id="clear">Clear</button>
            <!-- ğŸ—‘ï¸ PULISCI: Resetta tutto -->
          </div>
        </form>
        
        <div id="output" class="output hide"></div>
        <!-- ğŸ“Š OUTPUT: Nascosto inizialmente con classe "hide" -->
      </div>
    </main>
    
    <script>
      /* ğŸ§  ===== JAVASCRIPT: Il Cervello del Contatore ===== */
      
      // ğŸ¯ ===== SELEZIONE ELEMENTI DOM =====
      const calorieCounter = document.getElementById('calorie-counter');
      // ğŸ“ FORM: Il form principale
      
      const budgetNumberInput = document.getElementById('budget');
      // ğŸ’° INPUT BUDGET: Dove inserisci l'obiettivo calorico
      
      const entryDropdown = document.getElementById('entry-dropdown');
      // ğŸ“‹ DROPDOWN: Per selezionare il tipo di entry
      
      const addEntryButton = document.getElementById('add-entry');
      // â• BOTTONE ADD: Per aggiungere nuovi campi
      
      const clearButton = document.getElementById('clear');
      // ğŸ—‘ï¸ BOTTONE CLEAR: Per resettare tutto
      
      const output = document.getElementById('output');
      // ğŸ“Š OUTPUT: Dove mostriamo i risultati
      
      let isError = false;
      // ğŸš¨ FLAG ERRORE: Tiene traccia se c'Ã¨ un errore
      // let = puÃ² cambiare durante l'esecuzione
      
      // ğŸ§¹ ===== FUNZIONE PULIZIA STRINGA =====
      function cleanInputString(str) {
        const regex = /[+-\s]/g;
        // ğŸ” REGEX: Pattern per trovare caratteri da rimuovere
        // [+-\s] = trova +, - o spazi
        // g = global, trova tutte le occorrenze
        
        return str.replace(regex, '');
        // ğŸ§¹ PULISCE: Rimuove +, - e spazi
        // Es: "+100" â†’ "100", "- 50" â†’ "50"
      }
      
      // ğŸš« ===== VALIDAZIONE INPUT =====
      function isInvalidInput(str) {
        const regex = /\d+e\d+/i;
        // ğŸ”¬ REGEX SCIENTIFICA: Trova notazione scientifica
        // \d+ = una o piÃ¹ cifre
        // e = la lettera 'e'
        // \d+ = una o piÃ¹ cifre
        // i = case insensitive (E o e)
        // Es: "1e10", "5E3" (notazione scientifica)
        
        return str.match(regex);
        // ğŸ” MATCH: Ritorna l'array del match o null
        // Se trova notazione scientifica = invalido!
      }
      
      // â• ===== AGGIUNGI NUOVA ENTRY =====
      function addEntry() {
        const targetInputContainer = document.querySelector(`#${entryDropdown.value} .input-container`);
        // ğŸ¯ TROVA CONTAINER: Usa il valore del dropdown
        // Template literal con backticks ``
        // Es: se dropdown = "breakfast" â†’ "#breakfast .input-container"
        
        const entryNumber = targetInputContainer.querySelectorAll('input[type="text"]').length + 1;
        // ğŸ”¢ CONTA ENTRIES: Quanti input di testo ci sono giÃ  + 1
        // Per numerare progressivamente le entries
        
        const HTMLString = `
        <label for="${entryDropdown.value}-${entryNumber}-name">Entry ${entryNumber} Name</label>
        <input type="text" id="${entryDropdown.value}-${entryNumber}-name" placeholder="Name" />
        <label for="${entryDropdown.value}-${entryNumber}-calories">Entry ${entryNumber} Calories</label>
        <input
          type="number"
          min="0"
          id="${entryDropdown.value}-${entryNumber}-calories"
          placeholder="Calories"
        />`;
        // ğŸ“ TEMPLATE HTML: Crea dinamicamente i nuovi campi
        // Template literals permettono multilinea e interpolazione
        // ${} = inserisce variabili JavaScript
        // Risultato: breakfast-1-name, breakfast-1-calories, ecc.
        
        targetInputContainer.insertAdjacentHTML('beforeend', HTMLString);
        // ğŸ’‰ INIETTA HTML: Aggiunge alla fine del container
        // 'beforeend' = dentro l'elemento, dopo l'ultimo figlio
        // Ãˆ come aggiungere una riga al tuo diario alimentare!
      }
      
      // ğŸ§® ===== CALCOLA LE CALORIE =====
      function calculateCalories(e) {
        e.preventDefault();
        // ğŸ›‘ BLOCCA DEFAULT: Impedisce il refresh della pagina
        // I form di default ricaricano la pagina!
        
        isError = false;
        // ğŸ”„ RESET FLAG: Azzera lo stato di errore
      
        // ğŸ” ===== SELEZIONA TUTTI GLI INPUT NUMERICI =====
        const breakfastNumberInputs = document.querySelectorAll("#breakfast input[type='number']");
        const lunchNumberInputs = document.querySelectorAll("#lunch input[type='number']");
        const dinnerNumberInputs = document.querySelectorAll("#dinner input[type='number']");
        const snacksNumberInputs = document.querySelectorAll("#snacks input[type='number']");
        const exerciseNumberInputs = document.querySelectorAll("#exercise input[type='number']");
        // ğŸ“Š NODELIST: Array-like di tutti gli input numerici per categoria
        // querySelectorAll = trova TUTTI gli elementi che matchano
      
        // ğŸ§® ===== CALCOLA CALORIE PER CATEGORIA =====
        const breakfastCalories = getCaloriesFromInputs(breakfastNumberInputs);
        const lunchCalories = getCaloriesFromInputs(lunchNumberInputs);
        const dinnerCalories = getCaloriesFromInputs(dinnerNumberInputs);
        const snacksCalories = getCaloriesFromInputs(snacksNumberInputs);
        const exerciseCalories = getCaloriesFromInputs(exerciseNumberInputs);
        const budgetCalories = getCaloriesFromInputs([budgetNumberInput]);
        // ğŸ”¢ TOTALI: Somma le calorie di ogni categoria
        // Nota: budget Ã¨ in array [] perchÃ© Ã¨ un singolo elemento
      
        if (isError) {
          return;
          // ğŸš« STOP: Se c'Ã¨ stato un errore, ferma tutto
        }
      
        // ğŸ§® ===== CALCOLI FINALI =====
        const consumedCalories = breakfastCalories + lunchCalories + dinnerCalories + snacksCalories;
        // ğŸ½ï¸ CONSUMATE: Tutto quello che hai mangiato
        
        const remainingCalories = budgetCalories - consumedCalories + exerciseCalories;
        // ğŸ’° RIMANENTI: Budget - consumate + bruciate con esercizio
        // Esercizio si AGGIUNGE perchÃ© brucia calorie!
        
        const surplusOrDeficit = remainingCalories < 0 ? 'Surplus' : 'Deficit';
        // ğŸš¦ STATO: Se negativo = surplus (hai mangiato troppo)
        // Se positivo = deficit (sei sotto il budget)
        // Operatore ternario: condizione ? vero : falso
        
        // ğŸ“Š ===== MOSTRA RISULTATI =====
        output.innerHTML = `
        <span class="${surplusOrDeficit.toLowerCase()}">${Math.abs(remainingCalories)} Calorie ${surplusOrDeficit}</span>
        <hr>
        <p>${budgetCalories} Calories Budgeted</p>
        <p>${consumedCalories} Calories Consumed</p>
        <p>${exerciseCalories} Calories Burned</p>
        `;
        // ğŸ“ TEMPLATE OUTPUT: Mostra tutti i dati
        // Math.abs() = valore assoluto (rimuove il segno -)
        // .toLowerCase() = trasforma in minuscolo per la classe CSS
      
        output.classList.remove('hide');
        // ğŸ‘ï¸ MOSTRA: Rimuove la classe che nasconde l'output
      }
      
      // ğŸ”¢ ===== ESTRAI CALORIE DAGLI INPUT =====
      function getCaloriesFromInputs(list) {
        let calories = 0;
        // ğŸ”¢ ACCUMULATORE: Parte da zero
      
        for (const item of list) {
          // ğŸ”„ LOOP: Per ogni input nella lista
          
          const currVal = cleanInputString(item.value);
          // ğŸ§¹ PULISCI: Rimuovi caratteri non voluti
          
          const invalidInputMatch = isInvalidInput(currVal);
          // ğŸ” VALIDA: Controlla notazione scientifica
      
          if (invalidInputMatch) {
            alert(`Invalid Input: ${invalidInputMatch[0]}`);
            // ğŸš¨ ALERT: Mostra errore all'utente
            // [0] = primo elemento del match array
            
            isError = true;
            // ğŸš© SETTA FLAG: Marca che c'Ã¨ un errore
            
            return null;
            // ğŸ›‘ STOP: Esci dalla funzione
          }
          
          calories += Number(currVal);
          // â• ACCUMULA: Converti in numero e somma
          // Number() converte stringa in numero
        }
        return calories;
        // ğŸ“¤ RITORNA: Il totale delle calorie
      }
      
      // ğŸ—‘ï¸ ===== PULISCI FORM =====
      function clearForm() {
        const inputContainers = Array.from(document.querySelectorAll('.input-container'));
        // ğŸ”„ ARRAY.FROM: Converte NodeList in vero Array
        // Necessario per alcuni metodi array
      
        for (const container of inputContainers) {
          container.innerHTML = '';
          // ğŸ—‘ï¸ SVUOTA: Rimuove tutto l'HTML interno
          // Ãˆ come strappare le pagine dal diario
        }
      
        budgetNumberInput.value = '';
        // ğŸ”„ RESET BUDGET: Svuota il campo
        
        output.innerText = '';
        // ğŸ”„ RESET OUTPUT: Svuota il testo
        
        output.classList.add('hide');
        // ğŸ‘» NASCONDI: Aggiunge di nuovo la classe hide
      }
      
      // ğŸ§ ===== EVENT LISTENERS: Le Orecchie dell'App =====
      
      addEntryButton.addEventListener("click", addEntry);
      // ğŸ–±ï¸ CLICK ADD: Quando clicchi "Add Entry" â†’ esegui addEntry()
      
      calorieCounter.addEventListener("submit", calculateCalories);
      // ğŸ“¤ SUBMIT FORM: Quando invii il form â†’ esegui calculateCalories()
      
      clearButton.addEventListener("click", clearForm);
      // ğŸ—‘ï¸ CLICK CLEAR: Quando clicchi "Clear" â†’ esegui clearForm()
      
      /* ğŸ¯ ===== FLUSSO DELL'APP =====
      1. L'utente inserisce il budget calorico
      2. Seleziona una categoria dal dropdown
      3. Clicca "Add Entry" per aggiungere campi
      4. Inserisce nome e calorie del cibo/esercizio
      5. Ripete per tutti i pasti/esercizi
      6. Clicca "Calculate" per vedere i risultati
      7. L'app mostra se Ã¨ in surplus o deficit
      8. PuÃ² cliccare "Clear" per ricominciare
      
      Ãˆ come avere un nutrizionista digitale sempre con te! ğŸ¥—ğŸ“±
      */
    </script>
  </body>
</html>
